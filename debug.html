<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Debug - Selector de Categor√≠as</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .form-group { margin: 20px 0; }
        label { display: block; margin-bottom: 5px; }
        select { width: 100%; padding: 10px; font-size: 16px; }
        .debug-info { background: #f0f0f0; padding: 10px; margin: 10px 0; }
        button { padding: 10px 20px; margin: 5px; }
    </style>
</head>
<body>
    <h1>Debug - Selector de Categor√≠as</h1>
    
    <div class="debug-info">
        <h3>Estado del localStorage:</h3>
        <pre id="storage-debug"></pre>
    </div>
    
    <div class="form-group">
        <label>Tipo de transacci√≥n:</label>
        <input type="radio" name="type" value="income" id="income" checked>
        <label for="income">Ingreso</label>
        <input type="radio" name="type" value="expense" id="expense">
        <label for="expense">Gasto</label>
    </div>
    
    <div class="form-group">
        <label for="category">Categor√≠a:</label>
        <select id="category">
            <option value="">Selecciona una categor√≠a</option>
        </select>
    </div>
    
    <button onclick="debugStorage()">Ver Storage</button>
    <button onclick="initStorage()">Inicializar Storage</button>
    <button onclick="loadCategories()">Cargar Categor√≠as</button>
    <button onclick="clearStorage()">Limpiar Storage</button>
    
    <div class="debug-info">
        <h3>Categor√≠as cargadas:</h3>
        <pre id="categories-debug"></pre>
    </div>
    
    <script>
        class Storage {
            constructor() {
                this.STORAGE_KEY = 'expense_tracker_data';
            }
            
            initializeStorage() {
                if (!localStorage.getItem(this.STORAGE_KEY)) {
                    const initialData = {
                        transactions: [],
                        categories: {
                            income: [
                                { id: 'salary', name: 'Salario', icon: 'üí∞' },
                                { id: 'freelance', name: 'Trabajo Freelance', icon: 'üíª' },
                                { id: 'investment', name: 'Inversiones', icon: 'üìà' },
                                { id: 'other-income', name: 'Otros Ingresos', icon: 'üíµ' }
                            ],
                            expense: [
                                { id: 'food', name: 'Comida', icon: 'üçî' },
                                { id: 'transport', name: 'Transporte', icon: 'üöó' },
                                { id: 'utilities', name: 'Servicios', icon: 'üí°' },
                                { id: 'entertainment', name: 'Entretenimiento', icon: 'üéÆ' },
                                { id: 'shopping', name: 'Compras', icon: 'üõçÔ∏è' },
                                { id: 'health', name: 'Salud', icon: 'üè•' },
                                { id: 'education', name: 'Educaci√≥n', icon: 'üìö' },
                                { id: 'other-expense', name: 'Otros Gastos', icon: 'üìå' }
                            ]
                        }
                    };
                    this.saveData(initialData);
                    console.log('Storage inicializado con datos predeterminados');
                }
            }
            
            getData() {
                const data = localStorage.getItem(this.STORAGE_KEY);
                return data ? JSON.parse(data) : null;
            }
            
            saveData(data) {
                localStorage.setItem(this.STORAGE_KEY, JSON.stringify(data));
            }
        }
        
        const storage = new Storage();
        
        function debugStorage() {
            const data = storage.getData();
            document.getElementById('storage-debug').textContent = JSON.stringify(data, null, 2);
        }
        
        function initStorage() {
            storage.initializeStorage();
            debugStorage();
            loadCategories();
        }
        
        function clearStorage() {
            localStorage.removeItem('expense_tracker_data');
            document.getElementById('storage-debug').textContent = 'Storage limpiado';
            document.getElementById('categories-debug').textContent = '';
            document.getElementById('category').innerHTML = '<option value="">Selecciona una categor√≠a</option>';
        }
        
        function loadCategories() {
            const data = storage.getData();
            const categorySelect = document.getElementById('category');
            const typeRadio = document.querySelector('input[name="type"]:checked');
            
            if (!data || !data.categories) {
                document.getElementById('categories-debug').textContent = 'No hay datos de categor√≠as';
                return;
            }
            
            if (!typeRadio) {
                document.getElementById('categories-debug').textContent = 'No hay tipo seleccionado';
                return;
            }
            
            const selectedType = typeRadio.value;
            const categories = data.categories[selectedType];
            
            // Limpiar select
            categorySelect.innerHTML = '<option value="">Selecciona una categor√≠a</option>';
            
            if (categories && categories.length > 0) {
                categories.forEach(cat => {
                    const option = document.createElement('option');
                    option.value = cat.id;
                    option.textContent = `${cat.icon} ${cat.name}`;
                    categorySelect.appendChild(option);
                });
                
                document.getElementById('categories-debug').textContent = 
                    `Cargadas ${categories.length} categor√≠as de ${selectedType}:\n` +
                    JSON.stringify(categories, null, 2);
            } else {
                document.getElementById('categories-debug').textContent = 
                    `No hay categor√≠as para ${selectedType}`;
            }
        }
        
        // Event listeners
        document.querySelectorAll('input[name="type"]').forEach(radio => {
            radio.addEventListener('change', loadCategories);
        });
        
        // Inicializar al cargar
        window.addEventListener('load', () => {
            debugStorage();
            loadCategories();
        });
    </script>
</body>
</html> 