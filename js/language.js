// Traducciones para todas las páginas
const translations = {
    'es': {
        // Página de bienvenida
        welcomeTitle: 'Mi Gestor Financiero',
        welcomeSubtitle: 'Controla tus finanzas de manera fácil y segura',
        login: 'Iniciar Sesión',
        register: 'Registrarse',
        selectLanguage: 'Selecciona tu idioma:',
        
        // Página de PIN
        enterPin: 'Ingresa tu PIN',
        enterPinDesc: 'Introduce el PIN de 4 dígitos para acceder',
        welcomeBack: 'Bienvenido de nuevo,',
        pinError: 'PIN incorrecto. Intenta de nuevo.',
        notYourAccount: '¿No es tu cuenta?',
        access: 'Acceder',
        
        // Página de ajustes
        settings: 'Ajustes',
        appearance: 'Apariencia',
        theme: 'Tema',
        language: 'Idioma',
        security: 'Seguridad',
        securityPin: 'PIN de seguridad',
        changeSecurityOptions: 'Cambiar opciones de seguridad',
        data: 'Datos',
        exportData: 'Exportar datos',
        importData: 'Importar datos',
        deleteData: 'Eliminar todos los datos',
        account: 'Cuenta',
        logout: 'Cerrar sesión',
        about: 'Acerca de',
        
        // Temas
        themeGreen: 'Verde (Predeterminado)',
        themeBlue: 'Azul',
        themePurple: 'Púrpura',
        themeRed: 'Rojo',
        themeOrange: 'Naranja',
        themeGray: 'Gris',
        themeDark: 'Modo Oscuro',
        
        // Mensajes
        confirmLogout: '¿Estás seguro de que quieres cerrar sesión?',
        confirmDelete: '¿Estás seguro de que quieres eliminar todos los datos? Esta acción no se puede deshacer.',
        dataExported: 'Datos exportados correctamente',
        dataImported: 'Datos importados correctamente',
        dataDeleted: 'Todos los datos han sido eliminados',
        languageChanged: 'Idioma cambiado a Español',
        pinEnabled: 'PIN habilitado',
        pinDisabled: 'PIN deshabilitado'
    },
    'en': {
        welcomeTitle: 'My Financial Manager',
        welcomeSubtitle: 'Control your finances easily and securely',
        login: 'Login',
        register: 'Register',
        selectLanguage: 'Select your language:',
        
        enterPin: 'Enter your PIN',
        enterPinDesc: 'Enter the 4-digit PIN to access',
        welcomeBack: 'Welcome back,',
        pinError: 'Incorrect PIN. Try again.',
        notYourAccount: 'Not your account?',
        access: 'Access',
        
        settings: 'Settings',
        appearance: 'Appearance',
        theme: 'Theme',
        language: 'Language',
        security: 'Security',
        securityPin: 'Security PIN',
        changeSecurityOptions: 'Change security options',
        data: 'Data',
        exportData: 'Export data',
        importData: 'Import data',
        deleteData: 'Delete all data',
        account: 'Account',
        logout: 'Logout',
        about: 'About',
        
        themeGreen: 'Green (Default)',
        themeBlue: 'Blue',
        themePurple: 'Purple',
        themeRed: 'Red',
        themeOrange: 'Orange',
        themeGray: 'Gray',
        themeDark: 'Dark Mode',
        
        confirmLogout: 'Are you sure you want to logout?',
        confirmDelete: 'Are you sure you want to delete all data? This action cannot be undone.',
        dataExported: 'Data exported successfully',
        dataImported: 'Data imported successfully',
        dataDeleted: 'All data has been deleted',
        languageChanged: 'Language changed to English',
        pinEnabled: 'PIN enabled',
        pinDisabled: 'PIN disabled'
    },
    'pt': {
        welcomeTitle: 'Meu Gerenciador Financeiro',
        welcomeSubtitle: 'Controle suas finanças de forma fácil e segura',
        login: 'Entrar',
        register: 'Registrar',
        selectLanguage: 'Selecione seu idioma:',
        
        enterPin: 'Digite seu PIN',
        enterPinDesc: 'Digite o PIN de 4 dígitos para acessar',
        welcomeBack: 'Bem-vindo de volta,',
        pinError: 'PIN incorreto. Tente novamente.',
        notYourAccount: 'Não é sua conta?',
        access: 'Acessar',
        
        settings: 'Configurações',
        appearance: 'Aparência',
        theme: 'Tema',
        language: 'Idioma',
        security: 'Segurança',
        securityPin: 'PIN de segurança',
        changeSecurityOptions: 'Alterar opções de segurança',
        data: 'Dados',
        exportData: 'Exportar dados',
        importData: 'Importar dados',
        deleteData: 'Excluir todos os dados',
        account: 'Conta',
        logout: 'Sair',
        about: 'Sobre',
        
        themeGreen: 'Verde (Padrão)',
        themeBlue: 'Azul',
        themePurple: 'Roxo',
        themeRed: 'Vermelho',
        themeOrange: 'Laranja',
        themeGray: 'Cinza',
        themeDark: 'Modo Escuro',
        
        confirmLogout: 'Tem certeza que deseja sair?',
        confirmDelete: 'Tem certeza que deseja excluir todos os dados? Esta ação não pode ser desfeita.',
        dataExported: 'Dados exportados com sucesso',
        dataImported: 'Dados importados com sucesso',
        dataDeleted: 'Todos os dados foram excluídos',
        languageChanged: 'Idioma alterado para Português',
        pinEnabled: 'PIN ativado',
        pinDisabled: 'PIN desativado'
    },
    'fr': {
        welcomeTitle: 'Mon Gestionnaire Financier',
        welcomeSubtitle: 'Contrôlez vos finances facilement et en toute sécurité',
        login: 'Connexion',
        register: 'S\'inscrire',
        selectLanguage: 'Sélectionnez votre langue:',
        
        enterPin: 'Entrez votre PIN',
        enterPinDesc: 'Entrez le code PIN à 4 chiffres pour accéder',
        welcomeBack: 'Bon retour,',
        pinError: 'PIN incorrect. Réessayez.',
        notYourAccount: 'Ce n\'est pas votre compte?',
        access: 'Accéder',
        
        settings: 'Paramètres',
        appearance: 'Apparence',
        theme: 'Thème',
        language: 'Langue',
        security: 'Sécurité',
        securityPin: 'PIN de sécurité',
        changeSecurityOptions: 'Modifier les options de sécurité',
        data: 'Données',
        exportData: 'Exporter les données',
        importData: 'Importer les données',
        deleteData: 'Supprimer toutes les données',
        account: 'Compte',
        logout: 'Déconnexion',
        about: 'À propos',
        
        themeGreen: 'Vert (Par défaut)',
        themeBlue: 'Bleu',
        themePurple: 'Violet',
        themeRed: 'Rouge',
        themeOrange: 'Orange',
        themeGray: 'Gris',
        themeDark: 'Mode Sombre',
        
        confirmLogout: 'Êtes-vous sûr de vouloir vous déconnecter?',
        confirmDelete: 'Êtes-vous sûr de vouloir supprimer toutes les données? Cette action ne peut pas être annulée.',
        dataExported: 'Données exportées avec succès',
        dataImported: 'Données importées avec succès',
        dataDeleted: 'Toutes les données ont été supprimées',
        languageChanged: 'Langue changée en Français',
        pinEnabled: 'PIN activé',
        pinDisabled: 'PIN désactivé'
    }
};

// Función para obtener el idioma actual
function getCurrentLanguage() {
    // Si hay un usuario logueado, usar su idioma
    if (localStorage.getItem('user_id')) {
        const userPrefix = localStorage.getItem('current_user_prefix');
        return localStorage.getItem(`${userPrefix}_language`) || 'es';
    }
    // Si no hay usuario pero hay un idioma temporal en la sesión, usarlo
    if (sessionStorage.getItem('temp_language')) {
        return sessionStorage.getItem('temp_language');
    }
    // Si no hay usuario ni idioma temporal, usar español por defecto
    return 'es';
}

// Función para cambiar el idioma
function changeLanguage(lang) {
    // Si hay un usuario logueado, guardar el idioma en sus preferencias
    if (localStorage.getItem('user_id')) {
        const userPrefix = localStorage.getItem('current_user_prefix');
        localStorage.setItem(`${userPrefix}_language`, lang);
    } else {
        // Si no hay usuario, guardar el idioma temporalmente en la sesión
        sessionStorage.setItem('temp_language', lang);
    }
    
    // Actualizar el idioma del documento
    document.documentElement.lang = lang;
    
    // Retornar las traducciones del idioma seleccionado
    return translations[lang] || translations['es'];
}

// Función para aplicar el idioma temporal al usuario después del login
function applyTempLanguage(userPrefix) {
    const tempLang = sessionStorage.getItem('temp_language');
    if (tempLang) {
        localStorage.setItem(`${userPrefix}_language`, tempLang);
        sessionStorage.removeItem('temp_language');
    }
}

// Función para limpiar el idioma temporal al cerrar sesión
function clearTempLanguage() {
    sessionStorage.removeItem('temp_language');
}

// Función para obtener las traducciones del idioma actual
function getTranslations() {
    const currentLang = getCurrentLanguage();
    return translations[currentLang] || translations['es'];
}

// Exportar las funciones y constantes necesarias
window.appLanguage = {
    translations,
    getCurrentLanguage,
    changeLanguage,
    getTranslations,
    applyTempLanguage,
    clearTempLanguage
}; 